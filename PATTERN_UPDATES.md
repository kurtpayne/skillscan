# Pattern Updates - February 2026

## 2026-02-13 (1): pull_request_target Untrusted Head Checkout Pattern

**Sources:**
- [GitHub Security Advisory - GHSA-h25v-8c87-rvm8 (Secrets exfiltration via `pull_request_target`)](https://github.com/spotipy-dev/spotipy/security/advisories/GHSA-h25v-8c87-rvm8)
- [NVD - CVE-2025-47928](https://nvd.nist.gov/vuln/detail/CVE-2025-47928)

**Event Summary:** Public advisory and NVD records describe a workflow anti-pattern where `pull_request_target` jobs check out untrusted fork PR head refs (`github.event.pull_request.head.ref` / `head.sha`). This allows attacker-controlled code to run with base-repository token/secrets context.

**New Patterns Added:**

### EXF-005: GitHub Actions untrusted PR head checkout reference
- **Category:** exfiltration
- **Severity:** high
- **Confidence:** 0.91
- **Pattern:** Detects `ref:` / `repository:` references to `github.event.pull_request.head.*` in workflow content.
- **Justification:** This is the exploit-enabling checkout marker highlighted by GHSA-h25v-8c87-rvm8 / CVE-2025-47928.
- **Mitigation:** Do not check out untrusted PR head refs in privileged workflows.

### CHN-005: pull_request_target with untrusted PR head checkout
- **Category:** exfiltration
- **Severity:** critical
- **Confidence:** 0.93
- **Pattern:** Chains `pull_request_target` event markers with `github.event.pull_request.head.*` checkout markers.
- **Justification:** Improves precision by requiring both privileged trigger context and untrusted checkout indicators.
- **Mitigation:** Use unprivileged `pull_request` jobs for untrusted code, and avoid secret-bearing contexts for fork-controlled refs.

**Version:** Rules updated from 2026.02.12.1 to 2026.02.13.1

**Testing:** Added coverage in `tests/test_rules.py::test_new_patterns_2026_02_13`, showcase validation in `tests/test_showcase_examples.py`, and fixture `examples/showcase/34_pr_target_checkout_exfil`.

---

## 2026-02-12 (1): BYOVD Security-Killer Toolkit Marker

**Sources:**
- [Security Affairs - Reynolds ransomware uses BYOVD to disable security before encryption](https://securityaffairs.com/187869/security/reynolds-ransomware-uses-byovd-to-disable-security-before-encryption.html)
- [NVD - CVE-2025-68947 (NSecKrnl vulnerable driver)](https://nvd.nist.gov/vuln/detail/CVE-2025-68947)

**Event Summary:** Recent ransomware reporting described payloads embedding BYOVD components that load vulnerable signed drivers (NSecKrnl / CVE-2025-68947) and kill AV/EDR processes before encryption. In skill/tool artifacts, direct references to these toolkit names and driver-service creation commands are high-signal indicators of malicious intent.

**New Pattern Added:**

### MAL-007: BYOVD security-killer toolkit marker
- **Category:** malware_pattern
- **Severity:** high
- **Confidence:** 0.87
- **Pattern:** Detects known BYOVD/AV-killer markers (`nseckrnl`, `TrueSightKiller`, `AuKill`, `Poortry`, `GhostDriver`, `Warp AVKiller`) and explicit `sc create` service creation for those names.
- **Justification:** Matches observed defense-evasion tradecraft in current ransomware operations while remaining narrowly scoped to low-noise strings.
- **Mitigation:** Remove BYOVD-related tool/driver references and service-creation guidance from skills/tools.

**Version:** Rules updated from 2026.02.11.2 to 2026.02.12.1

**Testing:** Added assertions in `tests/test_rules.py::test_new_patterns_2026_02_12`, showcase validation in `tests/test_showcase_examples.py`, and fixture `examples/showcase/33_byovd_security_killer`.

---

## 2026-02-11 (2): npm Lifecycle Shell-Bootstrap Pattern

**Sources:**
- [GitHub Advisory Database - CVE-2025-10894 (Malicious versions of Nx)](https://github.com/advisories/GHSA-cxm3-wv7p-598c)
- [StepSecurity - Shai-Hulud: Self-Replicating Worm Compromises 500+ NPM Packages](https://www.stepsecurity.io/blog/ctrl-tinycolor-and-40-npm-packages-compromised)
- [Zscaler ThreatLabz - Shai-Hulud V2 Poses Risk to NPM Supply Chain](https://www.zscaler.com/blogs/security-research/shai-hulud-v2-poses-risk-npm-supply-chain)

**Event Summary:** Recent npm supply-chain incidents repeatedly use `preinstall`/`postinstall` hooks as execution pivots for shell/bootstrap commands (`curl`, `wget`, `iwr`, `powershell`) to fetch or launch second-stage payloads during dependency install.

**New Pattern Added:**

### SUP-004: npm preinstall/postinstall shell bootstrap pattern
- **Category:** malware_pattern
- **Severity:** high
- **Confidence:** 0.89
- **Pattern:** Detects `package.json` `preinstall`/`postinstall` script values containing shell/bootstrap primitives such as `curl`, `wget`, `iwr/irm`, `powershell`, `cmd /c`, `bash -c`, or `sh -c`.
- **Justification:** Aligns to observed lifecycle-hook abuse in both targeted package compromises and broad worm-like npm propagation campaigns.
- **Mitigation:** Remove shell/bootstrap execution from install lifecycle hooks; move setup to explicit, reviewed commands.

**Version:** Rules updated from 2026.02.11.1 to 2026.02.11.2

**Testing:** Added assertions in `tests/test_rules.py::test_new_patterns_2026_02_11`, showcase validation in `tests/test_showcase_examples.py`, and fixture `examples/showcase/32_npm_shell_bootstrap`.

---

## 2026-02-10 (2): Windows Defender Exclusion + mshta Remote Execution Patterns

**Sources:**
- [VulnCheck - Metro4Shell: CVE-2025-11953 Exploitation in the Wild](https://www.vulncheck.com/blog/metro4shell_eitw)
- [The Hacker News - Hackers Exploit Metro4Shell RCE Flaw in React Native CLI npm Package](https://thehackernews.com/2026/02/hackers-exploit-metro4shell-rce-flaw-in.html)
- [CISA KEV - CVE-2025-11953](https://www.cisa.gov/known-exploited-vulnerabilities-catalog?field_cve=CVE-2025-11953)
- [Malwarebytes - Fake CAPTCHA websites hijack your clipboard to install information stealers](https://www.malwarebytes.com/blog/news/2025/03/fake-captcha-websites-hijack-your-clipboard-to-install-information-stealers)

**Event Summary:** Active exploitation of CVE-2025-11953 (Metro4Shell) observed since December 2025, added to CISA KEV catalog Feb 5, 2026. Attackers deliver Base64-encoded PowerShell that disables Windows Defender via `Add-MpPreference -ExclusionPath` and `Set-MpPreference -DisableRealtimeMonitoring`. Separate campaign uses CAPTCHA-based clipboard hijacking to trick users into running `mshta.exe` commands fetching remote HTA/VBScript payloads.

**New Patterns Added:**

### DEF-001: Windows Defender Exclusion Manipulation
- **Category:** malware_pattern
- **Severity:** critical
- **Confidence:** 0.95
- **Pattern:** Detects PowerShell `Add-MpPreference`/`Set-MpPreference` with `-Exclusion*` or `-DisableRealtimeMonitoring` flags.
- **Justification:** Core anti-analysis technique in Metro4Shell payloads and other Windows malware campaigns; programmatic security control disablement is never legitimate in skill/tool contexts.
- **Mitigation:** Remove all commands that disable or weaken Windows Defender protections.

### MAL-005: mshta.exe Remote Execution Pattern
- **Category:** malware_pattern
- **Severity:** high
- **Confidence:** 0.92
- **Pattern:** Detects `mshta` or `mshta.exe` invocations with `http://`, `https://`, or `\\` (UNC) paths.
- **Justification:** Widespread in clipboard hijacking campaigns; mshta is a Living-off-the-Land Binary (LOLBin) frequently abused to execute remote scripts without traditional download steps.
- **Mitigation:** Remove mshta.exe invocations that fetch remote HTA/VBScript payloads.

**Version:** Rules updated from 2026.02.10.1 to 2026.02.10.2

**Testing:** Added assertions in `tests/test_rules.py` (test_new_patterns_2026_02_10), showcase example `30_metro4shell_defender_bypass`.

---

## 2026-02-10 (1): Piped `echo|sed` Scoped-Write Bypass Pattern

**Sources:**
- [GitHub Advisory Database - CVE-2026-25723](https://github.com/advisories/GHSA-mhg7-666j-cqg4)
- [NVD - CVE-2026-25723](https://nvd.nist.gov/vuln/detail/CVE-2026-25723)

**Event Summary:** GitHub and NVD documented a command-injection/write-scope bypass in Claude Code where piped `echo | sed` operations could bypass intended write restrictions and redirect output into sensitive paths such as `.claude/` or outside the project root.

**New Pattern Added:**

### SUP-003: Piped sed write to out-of-scope or agent config path
- **Category:** malware_pattern
- **Severity:** high
- **Confidence:** 0.84
- **Pattern:** Detects `echo ... | sed ... >` redirection targeting `.claude/` and `../` style out-of-scope paths.
- **Justification:** Directly aligned to CVE-2026-25723 described behavior (piped sed with redirected write bypass).
- **Mitigation:** Replace shell rewrite/redirection primitives with scoped file APIs and path allowlists.

**Version:** Rules updated from 2026.02.09.5 to 2026.02.10.1

**Testing:** Added coverage in `tests/test_rules.py`, `tests/test_scan.py`, and showcase validation in `tests/test_showcase_examples.py`.

## 2026-02-09: npx Phantom Package / Registry Fallback Pattern

**Sources:**
- [Aikido - npx Confusion: Packages That Forgot to Claim Their Own Name](https://www.aikido.dev/blog/npx-confusion-unclaimed-package-names)
- [The Hacker News - Compromised dYdX npm and PyPI Packages Deliver Wallet Stealers and RAT Malware](https://thehackernews.com/2026/02/compromised-dydx-npm-and-pypi-packages.html)

**Event Summary:** Recent supply-chain reporting highlighted widespread abuse potential when `npx` commands reference package names that were never claimed. In that case, npm registry fallback can fetch and execute attacker-published code.

**New Pattern Added:**

### SUP-002: npx Registry Fallback Execution Without `--no-install`
- **Category:** malware_pattern
- **Severity:** high
- **Confidence:** 0.86
- **Pattern:** Detects `npx <package>` usage that lacks the `--no-install` safeguard on the same command line.
- **Justification:** Aikido reported large-scale real-world execution volume of phantom `npx` package names, and The Hacker News linked the same abuse class in ongoing package compromise reporting.
- **Mitigation:** Prefer explicit installs and use `npx --no-install` to prevent implicit registry fallback execution.

**Version:** Rules updated from 2026.02.09.4 to 2026.02.09.5

**Testing:** Added assertions in `tests/test_rules.py`, `tests/test_scan.py`, and showcase coverage in `tests/test_showcase_examples.py`.

---

## 2026-02-09: GitHub Actions Secrets-Dump Exfil Pattern

**Sources:**
- [StepSecurity - Shai-Hulud: Self-Replicating Worm Compromises 500+ NPM Packages](https://www.stepsecurity.io/blog/ctrl-tinycolor-and-40-npm-packages-compromised)
- [The Hacker News - Shai-Hulud v2 Spreads From npm to Maven, as Campaign Exposes Thousands of Secrets](https://thehackernews.com/2025/11/shai-hulud-v2-campaign-spreads-from-npm.html)

**Event Summary:** Supply-chain malware campaigns documented malicious GitHub Actions workflow persistence that serializes CI/CD secrets context and transmits it to attacker-controlled endpoints.

**New Patterns Added:**

### EXF-004: GitHub Actions Full Secrets Context Dump
- **Category:** exfiltration
- **Severity:** high
- **Confidence:** 0.93
- **Pattern:** Detects `${{ toJSON(secrets) }}` expansion, a high-risk full-secret serialization marker.
- **Justification:** Incident reports show `${{ toJSON(secrets) }}` used inside malicious workflows to dump all repository/org secrets.
- **Mitigation:** Never serialize the full secrets context; pass only minimally scoped secret values to specific steps.

### CHN-004: GitHub Actions Secrets Context with Outbound Network
- **Category:** exfiltration
- **Severity:** critical
- **Confidence:** 0.94
- **Pattern:** Chains GitHub Actions secrets-context markers with outbound network/exfil indicators.
- **Justification:** Improves precision by requiring both secret-context expansion and transfer behavior.
- **Mitigation:** Remove broad secrets context references and block outbound transfer of CI/CD secrets.

**Version:** Rules updated from 2026.02.09.3 to 2026.02.09.4

**Testing:** Added coverage in `tests/test_rules.py::test_new_patterns_2026_02_09` and showcase validation in `tests/test_showcase_examples.py`.

---

## 2026-02-09: dYdX Supply Chain Attack Patterns

**Source:** [The Hacker News - Compromised dYdX npm and PyPI Packages](https://thehackernews.com/2026/02/compromised-dydx-npm-and-pypi-packages.html)

**Event Summary:** Legitimate dYdX cryptocurrency packages on npm and PyPI were compromised to deliver wallet stealers and RAT malware. The attack targeted wallet credentials and included stealth remote command execution capabilities.

**New Patterns Added:**

### EXF-002: Cryptocurrency Wallet File Access
- **Category:** exfiltration
- **Severity:** high
- **Confidence:** 0.88
- **Pattern:** Detects access to crypto wallet files (wallet.dat, .keystore, mnemonic, private keys)
- **Justification:** dYdX attack specifically targeted wallet seed phrases and credentials
- **Mitigation:** Do not access wallet files or seed phrases; crypto operations should use secure key management

### MAL-004: Dynamic Code Evaluation Pattern
- **Category:** malware_pattern
- **Severity:** high
- **Confidence:** 0.85
- **Pattern:** Detects eval(), exec(), Function() constructor, and vm.run* patterns
- **Justification:** Python RAT component in dYdX attack used exec() for remote command execution
- **Mitigation:** Avoid eval/exec flows that execute arbitrary code strings; use explicit functions

### OBF-002: Stealth Execution Pattern
- **Category:** instruction_abuse
- **Severity:** medium
- **Confidence:** 0.8
- **Pattern:** Detects CREATE_NO_WINDOW, nohup with output redirection, hidden process execution
- **Justification:** dYdX RAT used CREATE_NO_WINDOW flag to execute without console window on Windows
- **Mitigation:** Remove hidden/stealth execution flags that obscure command behavior

**Version:** Rules updated from 2026.02.09.1 to 2026.02.09.2

**Testing:** All patterns validated with unit tests in `tests/test_rules.py::test_new_patterns_2026_02_09`

---

## 2026-02-09: DockerDash Meta-Context Injection Pattern

**Sources:**
- [Noma Security - DockerDash: Two Attack Paths, One AI Supply Chain Crisis](https://noma.security/blog/dockerdash-two-attack-paths-one-ai-supply-chain-crisis/)
- [The Hacker News - Docker Fixes Critical Ask Gordon AI Flaw Allowing Code Execution via Image Metadata](https://thehackernews.com/2026/02/docker-fixes-critical-ask-gordon-ai.html)

**Event Summary:** Researchers documented a meta-context injection path where malicious instructions embedded in Docker image metadata are interpreted by AI assistants and used to trigger MCP tool actions, including data exfiltration through markdown image beacons with interpolated data placeholders.

**New Pattern Added:**

### EXF-003: Markdown Image Beacon Exfiltration Pattern
- **Category:** exfiltration
- **Severity:** high
- **Confidence:** 0.84
- **Pattern:** Detects markdown image URLs containing likely exfil query keys (`data`, `dump`, `exfil`, `token`, `key`) with variable placeholders.
- **Justification:** DockerDash examples include image-beacon style exfiltration payloads embedded in metadata context.
- **Mitigation:** Block instruction-driven external image beacons with interpolated placeholders and treat all metadata/context as untrusted.

**Version:** Rules updated from 2026.02.09.2 to 2026.02.09.3
