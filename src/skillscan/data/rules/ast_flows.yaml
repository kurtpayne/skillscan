version: "2026.02.09.1"

secret_markers:
  - ".env"
  - "id_rsa"
  - "aws_access_key_id"
  - "credentials"
  - "secret"
  - "token"
  - "apikey"

secret_source_calls:
  - "os.getenv"
  - "dotenv_values"
  - "load_dotenv"

decode_calls:
  - "base64.b64decode"
  - "bytes.fromhex"
  - "zlib.decompress"
  - "marshal.loads"

exec_sink_calls:
  - "eval"
  - "exec"
  - "os.system"
  - "subprocess.run"
  - "subprocess.Popen"
  - "subprocess.call"

exec_sink_suffixes:
  - ".system"
  - ".run"
  - ".Popen"
  - ".call"

network_sink_calls:
  - "requests.post"
  - "requests.put"
  - "requests.get"
  - "requests.request"
  - "urllib.request.urlopen"
  - "socket.send"
  - "socket.sendall"
  - "smtplib.SMTP.sendmail"

network_sink_suffixes:
  - ".send"
  - ".sendall"
  - ".post"
  - ".put"
  - ".get"
  - ".request"
  - ".urlopen"
  - ".sendmail"

rules:
  - id: AST-001
    category: malware_pattern
    severity: critical
    confidence: 0.92
    title: Constructed input reaches execution sink
    mitigation: Remove dynamic code execution paths and avoid eval/exec/system sinks.

  - id: AST-002
    category: exfiltration
    severity: critical
    confidence: 0.9
    title: Potential secret data sent to network sink
    mitigation: Do not transmit credentials/secrets over network sinks.
